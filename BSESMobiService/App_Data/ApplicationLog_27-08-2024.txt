27-08-2024 17:38:13System.Data.OleDb.OleDbException: ORA-00904: "DIVISON": invalid identifier
ORA-00904: "DIVISON": invalid identifier
   at System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult hr)
   at System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS dbParams, Object& executeResult)
   at System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object& executeResult)
   at System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior behavior, Object& executeResult)
   at System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior behavior, String method)
   at System.Data.OleDb.OleDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.OleDb.OleDbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at DbFunction.dmlgetquery_mobint(String sql) in e:\ALL APPLICATIONS CODE\LATEST CODE LR_APP_20082024\BSES Mobi Service - 03122021_215_New_NAS Change\App_Code\DbFunction.cs:line 1020 SELECT SUB_DIVISION DIVISION , nvl(COUNT(*),0) Total , nvl(SUM(CASE WHEN (NC_ONM = 'N' OR ABN_TYP = 'N') THEN 1 ELSE 0 END),0) NCs ,nvl(SUM(CASE WHEN (NC_ONM = 'Y' OR ABN_TYP = 'Y') THEN 1 ELSE 0 END),0) Pending  FROM  DIV_SCHEME_SURVEILLANCE A, DIV_SCHEME_SURV_NC_TYP B WHERE  A.SNO_ID = B.OBSER_ID   AND TRUNC(A.ENTRY_DATE) BETWEEN TRUNC(TO_DATE('1/4/2024','dd/mm/yyyy')) AND TRUNC(TO_DATE('27/8/2024','dd/mm/yyyy'))  AND UPPER(SUB_DIVISION) =UPPER('OKHLA') AND CIRCLE = (SELECT DISTINCT CIRCLE FROM DIV_SCHEME_SURVEILLANCE WHERE UPPER(SUB_DIVISION) = UPPER('OKHLA') AND DIVISON = (SELECT DISTINCT DIVISON FROM DIV_SCHEME_SURVEILLANCE WHERE UPPER(SUB_DIVISION) = UPPER('OKHLA')))  AND (NC_TYPE LIKE '%01%' OR  NC_TYPE LIKE '%02%' OR  NC_TYPE LIKE '%05%'  OR  NC_TYPE LIKE '%07%'  OR  NC_TYPE LIKE '%08%' OR  NC_TYPE LIKE '%09%' OR  NC_TYPE LIKE '%10%' OR  NC_TYPE LIKE '%11%' OR  NC_TYPE LIKE '%12%' OR NC_TYPE LIKE '%13%' OR  NC_TYPE LIKE '%14%' OR  NC_TYPE LIKE '%15%'  OR  NC_TYPE LIKE '%16%'  OR  NC_TYPE LIKE '%20%' OR  NC_TYPE LIKE '%21%' OR  NC_TYPE LIKE '%22%' OR  NC_TYPE LIKE '%23%' OR  NC_TYPE LIKE '%24%' OR  NC_TYPE LIKE '%25%' OR  NC_TYPE LIKE '%29%' OR NC_TYPE LIKE '%30%' OR TYPE_OF_ABNORMALITY LIKE '%PL%' OR TYPE_OF_ABNORMALITY LIKE '%PPL%' )  GROUP BY SUB_DIVISION order by SUB_DIVISION	 
27-08-2024 17:39:25System.Data.OleDb.OleDbException: ORA-00933: SQL command not properly ended
ORA-00933: SQL command not properly ended
   at System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult hr)
   at System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS dbParams, Object& executeResult)
   at System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object& executeResult)
   at System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior behavior, Object& executeResult)
   at System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior behavior, String method)
   at System.Data.OleDb.OleDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.OleDb.OleDbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at DbFunction.dmlgetquery_mobint(String sql) in e:\ALL APPLICATIONS CODE\LATEST CODE LR_APP_20082024\BSES Mobi Service - 03122021_215_New_NAS Change\App_Code\DbFunction.cs:line 1020 SELECT SUB_DIVISION DIVISION , nvl(COUNT(*),0) Total , nvl(SUM(CASE WHEN (NC_ONM = 'N' OR ABN_TYP = 'N') THEN 1 ELSE 0 END),0) NCs ,nvl(SUM(CASE WHEN (NC_ONM = 'Y' OR ABN_TYP = 'Y') THEN 1 ELSE 0 END),0) Pending  FROM  DIV_SCHEME_SURVEILLANCE A, DIV_SCHEME_SURV_NC_TYP B WHERE  A.SNO_ID = B.OBSER_ID   AND TRUNC(A.ENTRY_DATE) BETWEEN TRUNC(TO_DATE('1/4/2024','dd/mm/yyyy')) AND TRUNC(TO_DATE('27/8/2024','dd/mm/yyyy'))  AND UPPER(SUB_DIVISION) =UPPER('OKHLA') AND UPPER(DIVISION) = (SELECT DISTINCT UPPER(DIVISION) AS DIVISION FROM MOBINT.DIV_SCM_SDC_MST_110524 WHERE UPPER(SUB_DIVISION) = UPPER('OKHLA')))  AND (NC_TYPE LIKE '%01%' OR  NC_TYPE LIKE '%02%' OR  NC_TYPE LIKE '%05%'  OR  NC_TYPE LIKE '%07%'  OR  NC_TYPE LIKE '%08%' OR  NC_TYPE LIKE '%09%' OR  NC_TYPE LIKE '%10%' OR  NC_TYPE LIKE '%11%' OR  NC_TYPE LIKE '%12%' OR NC_TYPE LIKE '%13%' OR  NC_TYPE LIKE '%14%' OR  NC_TYPE LIKE '%15%'  OR  NC_TYPE LIKE '%16%'  OR  NC_TYPE LIKE '%20%' OR  NC_TYPE LIKE '%21%' OR  NC_TYPE LIKE '%22%' OR  NC_TYPE LIKE '%23%' OR  NC_TYPE LIKE '%24%' OR  NC_TYPE LIKE '%25%' OR  NC_TYPE LIKE '%29%' OR NC_TYPE LIKE '%30%' OR TYPE_OF_ABNORMALITY LIKE '%PL%' OR TYPE_OF_ABNORMALITY LIKE '%PPL%' )  GROUP BY SUB_DIVISION order by SUB_DIVISION	 
27-08-2024 18:19:39System.Data.OleDb.OleDbException: 'OraOLEDB.Oracle' failed with no error message available, result code: E_FAIL(0x80004005).
   at System.Data.OleDb.OleDbDataReader.ProcessResults(OleDbHResult hr)
   at System.Data.OleDb.OleDbDataReader.GetRowHandles()
   at System.Data.OleDb.OleDbDataReader.ReadRowset()
   at System.Data.OleDb.OleDbDataReader.Read()
   at System.Data.Common.DataAdapter.FillLoadDataRow(SchemaMapping mapping)
   at System.Data.Common.DataAdapter.FillFromReader(DataSet dataset, DataTable datatable, String srcTable, DataReaderContainer dataReader, Int32 startRecord, Int32 maxRecords, DataColumn parentChapterColumn, Object parentChapterValue)
   at System.Data.Common.DataAdapter.Fill(DataTable[] dataTables, IDataReader dataReader, Int32 startRecord, Int32 maxRecords)
   at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior)
   at System.Data.Common.DbDataAdapter.Fill(DataTable dataTable)
   at DbFunction.dmlgetquery_mobint(String sql) in e:\ALL APPLICATIONS CODE\LATEST CODE LR_APP_20082024\BSES Mobi Service - 03122021_215_New_NAS Change\App_Code\DbFunction.cs:line 1020 SELECT DISTINCT SNO_ID, A.OBSERVATION_TYPE, VISIT_DATE, NVL(A.METER_NO, '0') METER_NO, NVL(A.CA_NUMBER,'0') CA_NUMBER, NVL(A.POLE_NO,'0') POLE_NO,  A.ACTION_TAKEN_FLG, REMARKS, OTHER_RKS, TYPE_OF_ABNORMALITY, SITE_ADDRESS, ADJ_METER_NO1, ADJ_METER_NO2,  NC_TYPE, UPPER(NEAR_POLE_NO) NEAR_POLE_NO, TO_CHAR(A.ENTRY_DATE,'dd/mm/yyyy') ENTRY_DT, LH.LEAD_STATUS  FROM DIV_SCHEME_SURVEILLANCE A INNER JOIN DIV_SCHEME_SURV_NC_TYP B  ON A.SNO_ID = B.OBSER_ID LEFT JOIN MOBINT.ENFORCEMENT_LEAD_HISTORY LH ON A.SNO_ID = LH.OBSERVATION_ID WHERE UPPER(A.DIVISION)=UPPER('MITRAON') AND UPPER(A.DIVISION) IN ('MITRAON') AND UPPER(SUB_DIVISION) IN ('MUNDELLA', 'CRPF', 'MITRAON') OR UPPER(A.DIVISION) IN ('JAFFARPUR') AND UPPER(SUB_DIVISION) IN ('MUNDELLA', 'CRPF', 'MITRAON') AND UPPER(SUB_DIVISION)=UPPER('CRPF')  AND (B.NC_ONM = 'Y' OR B.ABN_TYP = 'Y')  AND (NC_TYPE LIKE '%01%' OR  NC_TYPE LIKE '%02%' OR  NC_TYPE LIKE '%05%'  OR  NC_TYPE LIKE '%07%'  OR  NC_TYPE LIKE '%08%' OR  NC_TYPE LIKE '%09%' OR  NC_TYPE LIKE '%10%' OR  NC_TYPE LIKE '%11%' OR  NC_TYPE LIKE '%12%' OR  NC_TYPE LIKE '%13%' OR  NC_TYPE LIKE '%14%' OR  NC_TYPE LIKE '%15%'  OR  NC_TYPE LIKE '%16%'  OR  NC_TYPE LIKE '%20%' OR  NC_TYPE LIKE '%21%' OR  NC_TYPE LIKE '%22%' OR  NC_TYPE LIKE '%23%' OR  NC_TYPE LIKE '%24%' OR  NC_TYPE LIKE '%25%' OR  NC_TYPE LIKE '%29%' OR  NC_TYPE LIKE '%30%'  OR TYPE_OF_ABNORMALITY LIKE '%PL%' OR TYPE_OF_ABNORMALITY LIKE '%PPL%'  )    ORDER BY ENTRY_DT DESC 
